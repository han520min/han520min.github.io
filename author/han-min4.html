<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>韩敏的技术博客</title>
	<meta name="description" content="">
	<meta name="author" content="韩敏">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="/theme/bootstrap.min.css" rel="stylesheet">
	<link href="/theme/local.css" rel="stylesheet">
	<link href="/theme/pygments.css" rel="stylesheet">

	<!-- Feeds -->




</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="/">韩敏的技术博客</a>
			<ul class="nav">
					<li ><a href="/category/celery.html">celery</a></li>
					<li ><a href="/category/devops.html">DevOps</a></li>
					<li ><a href="/category/django.html">Django</a></li>
					<li ><a href="/category/git.html">GIT</a></li>
					<li ><a href="/category/ji-zhu.html">技术</a></li>
					<li ><a href="/category/jwt.html">jwt</a></li>
					<li ><a href="/category/linux.html">Linux</a></li>
					<li ><a href="/category/modelcao-zuo.html">model操作</a></li>
					<li ><a href="/category/myself.html">myself</a></li>
					<li ><a href="/category/rabbitmq.html">rabbitmq</a></li>
					<li ><a href="/category/redis.html">redis</a></li>
					<li ><a href="/category/supervisor.html">Supervisor</a></li>
					<li ><a href="/category/vue.html">VUE</a></li>
					<li ><a href="/category/yun-wei.html">运维</a></li>
			</ul>
			<p class="pull-right"><a href="/archives.html">[archives]</a> <a href="/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="http://getpelican.com/">Pelican</a></li>
				<li><a href="http://python.org/">Python.org</a></li>
				<li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="https://shangxiaoweia.github.io">shangwei</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
<div class="page-header"><h1>韩敏的技术博客 <small>韩敏</small></h1></div>
<div class='article'>
	<h2>加密</h2>
	<div class="well small">Permalink: <a class="more" href="/my-加密.html">2018-10-08 18:44:00+02:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/django.html">django</a>
tags: <a href="/tag/django.html">Django</a> </div>
	<div class="summary"><div class="highlight"><pre><span></span># 加密方法
<span class="nv">def</span> <span class="nv">make_password</span><span class="ss">(</span><span class="nv">mypass</span><span class="ss">)</span>:
    # <span class="nv">md5</span>算法
    <span class="nv">mypass</span> <span class="o">=</span> <span class="nv">hashlib</span>.<span class="nv">md5</span><span class="ss">()</span>
    # 对字符串进行编译<span class="ss">(</span>加盐操作<span class="ss">)</span>
    <span class="nv">mypass</span>.<span class="nv">update</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">123</span><span class="s1">&#39;</span>.<span class="nv">encode</span><span class="ss">(</span><span class="nv">encoding</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">utf-8</span><span class="s1">&#39;</span><span class="ss">))</span>
    # 返回密文
    <span class="k">return</span> <span class="nv">mypass</span>.<span class="nv">hexdigest</span><span class="ss">()</span>


# 登录接口
<span class="nv">class</span> <span class="nv">Login</span><span class="ss">(</span><span class="nv">APIView</span><span class="ss">)</span>:
    <span class="nv">def</span> <span class="nv">post</span><span class="ss">(</span><span class="nv">self</span>, <span class="nv">request</span><span class="ss">)</span>:
        # 接收参数
        <span class="nv">username</span> <span class="o">=</span> <span class="nv">request</span>.<span class="nv">POST</span>.<span class="nv">get</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">username</span><span class="s1">&#39;</span>, <span class="s1">&#39;</span><span class="s">未收到用户名</span><span class="s1">&#39;</span><span class="ss">)</span>
        <span class="nv">password</span> <span class="o">=</span> <span class="nv">request</span>.<span class="nv">POST</span>.<span class="nv">get</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">password</span><span class="s1">&#39;</span>, <span class="s1">&#39;</span><span class="s">未收到密码</span><span class="s1">&#39;</span><span class="ss">)</span>

        # 查询数据
        <span class="nv">user</span> <span class="o">=</span> <span class="nv">User</span>.<span class="nv">objects</span>.<span class="nv">filter</span><span class="ss">(</span><span class="nv">username</span><span class="o">=</span><span class="nv">username</span>, <span class="nv">password …</span></pre></div> <a class="btn primary xsmall" href="/my-加密.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>验证码</h2>
	<div class="well small">Permalink: <a class="more" href="/my-验证码.html">2018-10-08 18:44:00+02:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/django.html">django</a>
tags: <a href="/tag/django.html">Django</a> </div>
	<div class="summary"><div class="highlight"><pre><span></span># 定义验证码类
<span class="nv">class</span> <span class="nv">MyCode</span><span class="ss">(</span><span class="nv">View</span><span class="ss">)</span>:

    # 定义随机取色方法
    <span class="nv">def</span> <span class="nv">get_random_color</span><span class="ss">(</span><span class="nv">self</span><span class="ss">)</span>:
        <span class="nv">R</span> <span class="o">=</span> <span class="k">random</span>.<span class="nv">randrange</span><span class="ss">(</span><span class="mi">255</span><span class="ss">)</span>
        <span class="nv">G</span> <span class="o">=</span> <span class="k">random</span>.<span class="nv">randrange</span><span class="ss">(</span><span class="mi">255</span><span class="ss">)</span>
        <span class="nv">B</span> <span class="o">=</span> <span class="k">random</span>.<span class="nv">randrange</span><span class="ss">(</span><span class="mi">255</span><span class="ss">)</span>
        <span class="k">return</span> <span class="ss">(</span><span class="nv">R</span>, <span class="nv">G</span>, <span class="nv">B</span><span class="ss">)</span>

    <span class="nv">def</span> <span class="nv">get</span><span class="ss">(</span><span class="nv">self</span>, <span class="nv">request</span><span class="ss">)</span>:
        # 定义画布
        <span class="nv">img_size</span> <span class="o">=</span> <span class="ss">(</span><span class="mi">120</span>, <span class="mi">50</span><span class="ss">)</span>
        # 定义图像 颜色种类，画布，背景颜色
        <span class="nv">image</span> <span class="o">=</span> <span class="nv">Image</span>.<span class="nv">new</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">RGB</span><span class="s1">&#39;</span>, <span class="nv">img_size</span>, <span class="s1">&#39;</span><span class="s">white</span><span class="s1">&#39;</span><span class="ss">)</span>
        # 定义画笔
        <span class="nv">draw</span> <span class="o">=</span> <span class="nv">ImageDraw</span>.<span class="nv">Draw</span><span class="ss">(</span><span class="nv">image</span>, <span class="s1">&#39;</span><span class="s">RGB</span><span class="s1">&#39;</span><span class="ss">)</span>
        # 随机字符串组成
        <span class="nv">source …</span></pre></div> <a class="btn primary xsmall" href="/my-验证码.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>第三方微博登录</h2>
	<div class="well small">Permalink: <a class="more" href="/my-第三方微博登录.html">2018-09-08 18:44:00+02:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/django.html">django</a>
tags: <a href="/tag/django.html">Django</a> </div>
	<div class="summary"><div class="highlight"><pre><span></span># 定义新浪微博回调方法
<span class="nv">def</span> <span class="nv">weibo_back</span><span class="ss">(</span><span class="nv">request</span><span class="ss">)</span>:
    # 获取新浪微博回调的<span class="nv">code</span>
    <span class="nv">code</span> <span class="o">=</span> <span class="nv">request</span>.<span class="nv">GET</span>.<span class="nv">get</span><span class="ss">(</span><span class="s1">&#39;</span><span class="s">code</span><span class="s1">&#39;</span><span class="ss">)</span>
    # 微博认证地址
    <span class="nv">access_token_url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">https://api.weibo.com/oauth2/access_token</span><span class="s2">&quot;</span>
    # 发起<span class="nv">http</span>请求
    <span class="nv">re_dict</span> <span class="o">=</span> <span class="nv">requests</span>.<span class="nv">post</span><span class="ss">(</span>
        <span class="nv">access_token_url</span>,
        <span class="nv">data</span><span class="o">=</span>{
            # <span class="nv">app_id</span>  应用<span class="nv">id</span>
            <span class="s2">&quot;</span><span class="s">client_id</span><span class="s2">&quot;</span>: <span class="s1">&#39;</span><span class="s">2636039333</span><span class="s1">&#39;</span>,
            # <span class="nv">app_secret</span> 密钥
            <span class="s2">&quot;</span><span class="s">client_secret</span><span class="s2">&quot;</span>: <span class="s2">&quot;</span><span class="s">4e2fbdb39432c31dc5c2f90be3afa5ce</span><span class="s2">&quot;</span>,
            # 授权类型 <span class="nv">code</span>
            <span class="s2">&quot;</span><span class="s">grant_type</span><span class="s2">&quot;</span>: <span class="s2">&quot;</span><span class="s">authorization_code</span><span class="s2">&quot;</span>,
            # <span class="nv">code</span> 参数
            <span class="s2">&quot;</span><span class="s">code</span><span class="s2">&quot;</span>: <span class="nv">code</span>,
            # 回调网址
            <span class="s2">&quot;</span><span class="s">redirect_uri</span><span class="s2">&quot;</span>: <span class="s2">&quot;</span><span class="s">http://127.0.0 …</span></pre></div> <a class="btn primary xsmall" href="/my-第三方微博登录.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>获取客户端IP</h2>
	<div class="well small">Permalink: <a class="more" href="/my-获取客户端IP.html">2018-08-09 19:44:00+02:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/django.html">django</a>
tags: <a href="/tag/django.html">Django</a> </div>
	<div class="summary"><h2>获取客户端IP</h2>
<h3>request.META['REMOTE_ADDR']</h3>
<h2></h2> <a class="btn primary xsmall" href="/my-获取客户端IP.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>Django中F、Q</h2>
	<div class="well small">Permalink: <a class="more" href="/Django中F、Q.html">2018-08-08 18:44:00+02:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/django.html">django</a>
tags: <a href="/tag/django.html">Django</a> </div>
	<div class="summary"><h2>一、Q方法</h2>
<p>1.对关键字参数进行分装：</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">Q</span>
<span class="kn">from</span> <span class="nn">app01.models</span> <span class="kn">import</span> <span class="n">Userinfo</span>

<span class="n">userinfo</span> <span class="o">=</span> <span class="n">Userinfo</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">question__startswith</span><span class="o">=</span><span class="s1">&#39;王&#39;</span><span class="p">))</span>
</pre></div>


<ol>
<li>| 操作符</li>
</ol>
<p>```
   from django.db.models import Q
   from app01.models import Userinfo</p>
<p>userinfo = Userinfo.objects.filter(Q(question__startswith='王') | Q(question__startswith='六'))
   ```</p>
<p>3.Q对象可以用~操作表示否定</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db …</span></pre></div> <a class="btn primary xsmall" href="/Django中F、Q.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>Django多对多系列化与反序列化</h2>
	<div class="well small">Permalink: <a class="more" href="/Django多对多系列化与反序列化.html">2018-01-08 18:44:00+01:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/django.html">Django</a>
tags: <a href="/tag/django.html">Django</a> </div>
	<div class="summary"><h2>Django 序列化和反序列化</h2>
<p>一、 序列化</p>
<ul>
<li>
<p>查询所有的学生的信息，包括任课老师</p>
</li>
<li>
<p><code>models.py</code></p>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="c1"># 学生类</span>
<span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

    <span class="c1"># 老师类</span>
<span class="k">class</span> <span class="nc">Teacher</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
    <span class="n">students</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="s1">&#39;Student&#39;</span><span class="p">,</span><span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;teacher&#39;</span><span class="p">)</span>
</pre></div>


<ul>
<li><code>serializer.py</code></li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rest_framework</span> <span class="kn">import</span> <span class="n">serializers</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">models</span>

<span class="c1"># 老师序列化 …</span></pre></div> <a class="btn primary xsmall" href="/Django多对多系列化与反序列化.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>DevOps介绍</h2>
	<div class="well small">Permalink: <a class="more" href="/DevOps介绍.html">2017-12-24 18:44:00+01:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/devops.html">DevOps</a>
tags: <a href="/tag/devops.html">DevOps</a> </div>
	<div class="summary"><h1>1.1DevOps介绍</h1>
<h2>1、DevOps定义（是一种思想，大型公司）</h2>
<p>​       1、DevOps是“开发”和“运维”的缩写。</p>
<p>​       2、透过自动化“软件交付”和“架构变更”的流程，来使得构建、测试、发布软件能够更加地快捷、频繁和可靠。</p>
<h2>2、DevOps持续交付环</h2>
<p>​       1、开发交付：计划 - - &gt; 编码 - - &gt; 构架 - - &gt; 测试 - - &gt; 版本 - - &gt; 部署 - - &gt; 运维 - - &gt; 监控</p>
<h2>3、传统交付</h2>
<p>​       持续集成：代码合并，构建，部署，测试，不断进行，对结果反馈</p>
<p>​       持续部署：将产品部署在测试环境，预生产环境，生产环境</p>
<p>运维：维护线上服务的稳定，底层平台的运行 …</p> <a class="btn primary xsmall" href="/DevOps介绍.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>celery介绍</h2>
	<div class="well small">Permalink: <a class="more" href="/celery+redis.html">2017-12-24 18:44:00+01:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/celery.html">celery</a>
tags: <a href="/tag/celery.html">celery</a> </div>
	<div class="summary"><h3>1.1 Celery介绍</h3>
<p><strong>1、celery应用举例</strong></p>
<p>1、Celery 是一个 基于python开发的分布式异步消息任务队列，通过它可以轻松的实现任务的异步处理，
　　　　　　 　　 如果你的业务场景中需要用到异步任务，就可以考虑使用celery</p>
<p>2、你想对100台机器执行一条批量命令，可能会花很长时间 ，但你不想让你的程序等着结果返回，而是给你返回 一个任务ID,
　　　　　　　　你过一段时间只需要拿着这个任务id就可以拿到任务执行结果， 在任务执行ing进行时，你可以继续做其它的事情</p>
<p>3、Celery 在执行任务时需要通过一个消息中间件来接收和发送任务消息，以及存储任务结果， 一般使用rabbitMQ or Redis</p>
<p><strong>2、Celery有以下优点</strong></p>
<p>1、简单：一单熟悉了celery的工作流程后，配置和使用还是比较简单的</p>
<p>2、高可用：当任务执行失败或执行过程中发生连接中断，celery 会自动尝试重新执行任务</p>
<p>3、快速：一个单进程的celery每分钟可处理上百万个任务</p>
<p>4、灵活： 几乎celery的各个组件都可以被扩展及自定制</p>
<p><strong>3、Celery基本工作流程图</strong></p>
<p><img alt="img" src="https://images2018.cnblogs.com/blog/1080958/201807/1080958-20180713110226832-1531245622.png"></p>
<p><strong>user：</strong>用户程序，用于告知celery去执行一个任务 …</p> <a class="btn primary xsmall" href="/celery+redis.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>celery面试阐述</h2>
	<div class="well small">Permalink: <a class="more" href="/celery面试.html">2017-12-24 18:44:00+01:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/celery.html">celery</a>
tags: <a href="/tag/celery.html">celery</a> </div>
	<div class="summary"><h2>1.1面试从哪几个方面介绍celery</h2>
<ul>
<li>
<h3>What：什么是cerlery</h3>
</li>
<li>
<h3>Where : 在哪里用</h3>
</li>
<li>
<h3>Why : 为什么</h3>
</li>
<li>
<h3>How ： 如何用</h3>
</li>
</ul>
<p>​     接下来开始正题啦</p>
<hr>
<p>1 .  面试官想要什么答案？</p>
<ul>
<li>
<p>面试官希望能给结合项目中的业务来回答问题</p>
</li>
<li>
<p>对celery原理机制有自己的见解</p>
</li>
<li>
<p>对celery的缺点也有自己的认知</p>
</li>
<li>
<p>如果能说明白有哪些方案能替代celery，为什么当时选取的celery就更好了</p>
</li>
<li>
<p>针对这道题回答思路是什么？</p>
<ul>
<li>
<p>能够用简明通俗的语句说明白celery的特点(what)</p>
</li>
<li>
<p>然后剖析celery常见的使用场景(where)</p>
</li>
<li>
<p>项目中遇到什么业务场景而选用celery解决(why)</p>
</li>
<li>
<p>我们在项目中是如何使用celery(how)</p>
</li>
<li>
<p>细节1：使用celery遇到的坑</p>
</li>
<li>
<p>细节2：反思有没有更好的解决方案，为什么</p>
<ul>
<li>celery ：分布式消息队列（定时任务，异步任务）每分钟官方上可以执行上百万了任务（高效处理）</li>
</ul>
<blockquote>
<p>celery beat : 把任务发送给队列</p>
<p>Broker ： 消息队列</p>
<p>Producer：产生任务交给任务对列</p>
<p>celery worker ：执行任务的消费者</p>
<p>Request Backend …</p></blockquote></li></ul></li></ul> <a class="btn primary xsmall" href="/celery面试.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>django分页组件（paginator）</h2>
	<div class="well small">Permalink: <a class="more" href="/my-分页.html">2017-08-08 18:44:00+02:00</a>
by <a class="url fn" href="/author/han-min.html">韩敏 </a>
 in <a href="/category/django.html">django</a>
tags: <a href="/tag/django.html">Django</a> </div>
	<div class="summary"><h1>Django分页组件(paginator)</h1>
<blockquote>
<p><code>shell
from django.core.paginator import Paginator, EmptyPage, PageNotAnInteger</code></p>
</blockquote>
<div class="highlight"><pre><span></span>  Paginator
</pre></div>


<p>：创建分页对象</p>
<p>### 分页对象内置属性</p>
<div class="highlight"><pre><span></span><span class="nv">all_</span> <span class="o">=</span> models.objects.all<span class="o">()</span>
<span class="nv">p</span> <span class="o">=</span> Paginator<span class="o">(</span>all_, <span class="m">10</span><span class="o">)</span>
<span class="c1"># 分页all_数据，每页显示10条数据</span>
p.count <span class="c1"># 总数据量</span>
p.num_pages<span class="o">()</span> <span class="c1"># 分页数</span>
p.page_range<span class="o">()</span> <span class="c1"># 列表形式返回当前可有的页数 [1,2,3]</span>
<span class="nv">page_1</span> <span class="o">=</span> p.page<span class="o">(</span><span class="m">1</span><span class="o">)</span> <span class="c1"># 选择第一页，返回第一页数据对象</span>
</pre></div>


<h3>某一页内置属性</h3>
<div class="highlight"><pre><span></span>page_1.number <span class="c1"># 当前页的页码</span>
page_1.has_next<span class="o">()</span> <span class="c1"># 是否有下一页</span>
page_1 …</pre></div> <a class="btn primary xsmall" href="/my-分页.html">more…</a>
	</div>
</div>	

<div class="pagination">
<ul>
		<li class="prev"><a href="/author/han-min3.html">&larr; Previous</a></li>
		<li class=""><a href="/author/han-min.html">1</a></li>
		<li class=""><a href="/author/han-min2.html">2</a></li>
		<li class=""><a href="/author/han-min3.html">3</a></li>
		<li class="active"><a href="/author/han-min4.html">4</a></li>
		<li class="next disabled"><a href="#">&rarr; Next</a></li>
</ul>
</div>

		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; 韩敏</p>
		</footer>
	  </div>

	</div>
</body>
</html>